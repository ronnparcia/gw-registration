function addTicketNumber() {
  var sheet = SpreadsheetApp.getActiveSpreadsheet().getActiveSheet();
  var properties = PropertiesService.getScriptProperties();
  var lastTicketNumber = properties.getProperty("lastTicketNumber");
  lastTicketNumber = lastTicketNumber ? parseInt(lastTicketNumber) : 0;

  var ticketColumn = 1; 
  var timestampColumn = 2;
  
  var data = sheet.getDataRange().getValues();
  
  for (var i = 1; i < data.length; i++) {
    var row = data[i];
    var ticketCell = sheet.getRange(i + 1, ticketColumn);
    var timestampCell = row[timestampColumn - 1];
    
    if (!ticketCell.getValue() && timestampCell) {
      
      // itcket no increment
      lastTicketNumber++; 
      
      var timestamp = new Date(timestampCell);
      var month = String(timestamp.getMonth() + 1).padStart(2, "0");
      var day = String(timestamp.getDate()).padStart(2, "0");
      var dateCode = month + day;
      
      var ticketNumber = String(lastTicketNumber).padStart(5, "0") + "-" + dateCode;
      ticketCell.setValue(ticketNumber);
    }
  }
  
  // saves last number used
  properties.setProperty("lastTicketNumber", lastTicketNumber); 
}